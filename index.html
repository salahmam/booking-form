<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>سودوكو — المستويات والمراحل</title>
  <style>
    body {background:#0f0f12;color:#e9eef6;font-family:"Tajawal",sans-serif;margin:0;padding:0;display:grid;grid-template-rows:auto 1fr auto;min-height:100vh}
    header,footer{text-align:center;padding:12px}
    .board{width:min(92vw,500px);margin:20px auto;display:grid;gap:2px;background:#181a1f;padding:10px;border-radius:12px}
    .cell{display:grid;place-items:center;font-size:clamp(18px,3vw,24px);font-weight:800;background:#1f232b;border:1px solid #2f3644;border-radius:8px;outline:none;color:#e9eef6;text-align:center}
    input.cell{caret-color:#00d8ff}
    input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}
    .hud{display:flex;justify-content:space-around;align-items:center;flex-wrap:wrap;gap:10px;margin:10px auto}
    select,button{padding:8px 12px;border-radius:8px;border:1px solid #2f3644;background:#202735;color:#e9eef6;cursor:pointer}
    button:hover{background:#2a3446}
    .toolbar{text-align:center;margin:10px auto;display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
    .progress{height:8px;background:#11151b;border-radius:99px;overflow:hidden;width:200px}
    .progress>div{height:100%;width:0%;background:linear-gradient(90deg,#2f7bff,#00d8ff);transition:width .3s}
    #confetti{position:absolute;inset:0;pointer-events:none}
  </style>
</head>
<body>
<header><h1>🎲 سودوكو — المستويات والمراحل</h1></header>
<main>
  <div class="hud">
    <label>المستوى: <select id="level"></select></label>
    <label>المرحلة: <select id="stage"></select></label>
    <span id="timer">00:00</span>
    <div class="progress"><div id="progressBar"></div></div>
  </div>
  <div style="position:relative">
    <div id="board" class="board"></div>
    <canvas id="confetti"></canvas>
  </div>
  <div class="toolbar">
    <button id="btnCheck">تحقق</button>
    <button id="btnNext">التالي</button>
    <button id="btnReset">إعادة</button>
  </div>
  <!-- مكان إعلان Google -->
  <div style="text-align:center;margin:20px auto;">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-xxxxxxxxxxxxxxxx"
         data-ad-slot="1234567890"
         data-ad-format="auto"></ins>
  </div>
</main>
<footer>✨ بالتوفيق! ✨</footer>
<script>
const boardEl=document.getElementById("board"),levelSel=document.getElementById("level"),stageSel=document.getElementById("stage");
const progressEl=document.getElementById("progressBar"),timerEl=document.getElementById("timer");const SIDE9=9;
let SIDE=4,BOX=2,currentLevel=1,currentStage=1,startTime=null,timerInt=null,initialBoard=[],solutionBoard=[];
function formatTime(s){const m=Math.floor(s/60).toString().padStart(2,"0");const sec=(s%60).toString().padStart(2,"0");return m+":"+sec}
function startTimer(){if(timerInt)clearInterval(timerInt);startTime=Date.now();timerInt=setInterval(()=>{let e=Math.floor((Date.now()-startTime)/1000);timerEl.textContent=formatTime(e)},1e3)}
function stopTimer(){if(timerInt)clearInterval(timerInt)}
function shuffle(a){a=[...a];for(let i=a.length-1;i>0;i--){let j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}
function pattern(r,c){return(BOX*(r%BOX)+Math.floor(r/BOX)+c)%SIDE}
function generateFull(){const rBase=[0,1,2],rows=[].concat(...shuffle(rBase).map(g=>shuffle(rBase).map(r=>g*BOX+r)));
const cBase=[0,1,2],cols=[].concat(...shuffle(cBase).map(g=>shuffle(cBase).map(c=>g*BOX+c)));
const nums=shuffle([...Array(SIDE).keys()].map(x=>x+1));
return Array.from({length:SIDE},(_,r)=>Array.from({length:SIDE},(_,c)=>nums[pattern(rows[r],cols[c])]))}
function copyBoard(b){return b.map(r=>r.slice())}
function removeCells(board,blanks){const b=copyBoard(board);let removed=0,cells=shuffle([...Array(SIDE*SIDE).keys()]);
for(const idx of cells){if(removed>=blanks)break;const r=Math.floor(idx/SIDE),c=idx%SIDE;b[r][c]=0;removed++}return b}
function boxIndex(r,c){return Math.floor(r/BOX)*BOX+Math.floor(c/BOX)}
function buildBoard(puzzle){boardEl.innerHTML="";boardEl.style.gridTemplateColumns=`repeat(${SIDE},1fr)`;boardEl.style.gridTemplateRows=`repeat(${SIDE},1fr)`;
for(let r=0;r<SIDE;r++){for(let c=0;c<SIDE;c++){const v=puzzle[r][c];
if(v!==0){const div=document.createElement("div");div.className="cell";div.dataset.r=r;div.dataset.c=c;div.dataset.editable="false";div.textContent=v;boardEl.appendChild(div)}
else{const input=document.createElement("input");input.className="cell";input.type="number";input.inputMode="numeric";input.pattern="[0-9]*";
input.dataset.r=r;input.dataset.c=c;input.dataset.editable="true";
input.addEventListener("input",()=>{if(input.value.length>1)input.value=input.value.slice(-1);updateProgress();playClickSound()});boardEl.appendChild(input)}}}
updateProgress();startTimer()}
function readBoardFromDOM(){const b=Array.from({length:SIDE},()=>Array(SIDE).fill(0));
boardEl.querySelectorAll(".cell").forEach(cell=>{const r=+cell.dataset.r,c=+cell.dataset.c;
let val=cell.tagName==="INPUT"?cell.value.trim():cell.textContent.trim();b[r][c]=val?+val:0});return b}
function updateProgress(){const b=readBoardFromDOM();const filled=b.flat().filter(x=>x!==0).length;
const total=SIDE*SIDE-initialBoard.flat().filter(x=>x!==0).length;const current=Math.max(0,filled-initialBoard.flat().filter(x=>x!==0).length);
progressEl.style.width=Math.round(current/total*100)+"%"}
function checkBoard(){const b=readBoardFromDOM();for(let r=0;r<SIDE;r++){for(let c=0;c<SIDE;c++){const val=b[r][c];if(val===0)return}}
stopTimer();playWinSound();celebrate()}
let confettiPieces=[];const confettiCanvas=document.getElementById("confetti"),ctx=confettiCanvas.getContext("2d");
function confettiResize(){confettiCanvas.width=boardEl.clientWidth;confettiCanvas.height=boardEl.clientHeight}
function spawnConfetti(n=100){const colors=["#27c93f","#ffcc00","#2f7bff","#ea3b2d","#00d8ff"];
confettiPieces=Array.from({length:n},()=>({x:Math.random()*confettiCanvas.width,y:-10-Math.random()*40,r:2+Math.random()*4,c:colors[Math.floor(Math.random()*colors.length)],v:1+Math.random()*2.5,w:Math.random()*1.5,a:Math.random()*Math.PI*2}))}
function drawConfetti(){ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
for(const p of confettiPieces){p.a+=.05;p.y+=p.v;p.x+=Math.sin(p.a)*p.w;ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,2*Math.PI);ctx.fillStyle=p.c;ctx.fill()}confettiPieces=confettiPieces.filter(p=>p.y<confettiCanvas.height+10);
if(confettiPieces.length)requestAnimationFrame(drawConfetti)}
function celebrate(){spawnConfetti();drawConfetti()}
const clickSound=new Audio("https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg");
function playClickSound(){clickSound.currentTime=0;clickSound.play()}
const winSound=new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg");
function playWinSound(){winSound.currentTime=0;winSound.play()}
function blanksFor(stage){return Math.floor(SIDE*SIDE*0.5)}
function newStage(level,stage){currentLevel=level;currentStage=stage;SIDE=level+3;BOX=Math.floor(Math.sqrt(SIDE));
const full=generateFull();solutionBoard=full;initialBoard=removeCells(full,blanksFor(stage));buildBoard(initialBoard)}
document.getElementById("btnCheck").onclick=checkBoard;
document.getElementById("btnReset").onclick=()=>{buildBoard(initialBoard)};
document.getElementById("btnNext").onclick=()=>{let ns=currentStage+1;if(ns>10){currentLevel=currentLevel%6+1;ns=1}newStage(currentLevel,ns);stageSel.value=ns;levelSel.value=currentLevel};
function buildSelectors(){for(let l=1;l<=6;l++){let opt=document.createElement("option");opt.value=l;opt.textContent="مستوى "+l;levelSel.appendChild(opt)}
for(let s=1;s<=10;s++){let opt=document.createElement("option");opt.value=s;opt.textContent="مرحلة "+s;stageSel.appendChild(opt)}
levelSel.onchange=()=>newStage(+levelSel.value,+stageSel.value);stageSel.onchange=()=>newStage(+levelSel.value,+stageSel.value)}
window.addEventListener("resize",confettiResize);
buildSelectors();newStage(1,1);
</script>
</body>
</html>"""

# حفظ الملف كـ sudoku.html
path = "/mnt/data/sudoku.html"
with open(path, "w", encoding="utf-8") as f:
    f.write(html_code)

path